{% extends 'base.html.twig' %}

{% block title %}SgrEvento index{% endblock %}

{% block body %}
	<div class="row">
		<p>Informaci贸n, navegaci贸n y configuraci贸n</p>
	</div>
	
	<div class="row">
	<div class="col">
		
	<table class="table table-striped table-bordered ">
		<caption>Cuadrante de ocupaci贸n</caption>
		<thead class="thead-dark">
			<tr>
				<th scope="col" style="max-width: 100px"><div class="col">Hora</div></th>
				
				{% set start_h = constant('\\App\\Entity\\SgrEvento::H_INICIO_MIN') | date('U') %}
				{% set end_h = constant('\\App\\Entity\\SgrEvento::H_FIN_MAX') | date('U') %}	
				{% set step = 180*60 %} {# 3 horas en segundos #}
				{% set setpMinutes = 180 %} {# 3 horas en minutos #}
				
				 
				{% for hour in range(start_h, end_h, step) %}
				
						<th scope="col" >
							<div class="col text-center" ><span >{{ hour|date('H:i') }}</span> - <span>{{ (hour + step)|date('H:i') }}</span></div>
						</th>
					
				{% endfor %}
				
				
			</tr>
		</thead>
		<tbody>
					
			{% for calendario in aCalendarios %}
				<tr>
					<th scope="row" >
						<div class="col">{{ calendario.sgrEspacio.nombre }}</div>
					</th>

				{% for hour in range(start_h, end_h, step) %}	
					<td style="padding: 0px;overflow: hidden;">
						<div class="e" style="position: relative;min-height: 50px;height: 100%;">

							
						<div style="width:100%;position: absolute;min-height: 35px;height: 100%;">
							{% for i in range(0,2) %}
							<div style="float: left;width: 33%;height: 100%;border-left: 1px dotted gray;"></div>	
							{% endfor %}

						</div>
			
					
								
						
							{% if not calendario.periods is empty %}
								{% for period in calendario.periods %}
												
									{% if period.datePeriod.start|date('H:i') >= hour|date('H:i') and period.datePeriod.start|date('H:i') < (hour+step)|date('H:i') %}
										<div style="
											width: Calc(100% - {{ setpMinutes - calendario.duration(period.datePeriod) }}px);
											position:absolute;top:{{hour / 60}};background-color: #999;">
												{{ period.evento.titulo }}
										</div>
									{% endif %}
								{% endfor %}
							{% endif %}
						
						</div>
					</td>
				{% endfor %}
					
			</tr>
			{% endfor %}
		</tbody>
	</table>
	</div><!-- /.col -->
	</div><!-- /.row -->

{% endblock %}
{# composer req twig/intl-extra #}